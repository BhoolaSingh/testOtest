<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz</title>
    <script>
        // Placeholder for quiz answers and marks (you can replace this with real questions and logic)
        const correctAnswers = ['A', 'B', 'C', 'D']; // Correct answers for the quiz

        // Array to store the data of all students (name and marks)
        const studentData = JSON.parse(localStorage.getItem('studentData')) || [];

        // Function to submit quiz
        function submitQuiz() {
            let score = 0;

            // Get answers from the form (replace this logic with real quiz answers)
            const answers = [
                document.querySelector('input[name="q1"]:checked')?.value,
                document.querySelector('input[name="q2"]:checked')?.value,
                document.querySelector('input[name="q3"]:checked')?.value,
                document.querySelector('input[name="q4"]:checked')?.value
            ];

            // Calculate score
            answers.forEach((answer, index) => {
                if (answer === correctAnswers[index]) {
                    score++;
                }
            });

            // Get the student's name from session storage
            const studentName = sessionStorage.getItem('studentName');
            if (!studentName) {
                alert("Student name not found. Please start again.");
                window.location.href = 'index.html'; // Redirect to name entry page
                return;
            }

            // Store the student's name and score
            studentData.push({ name: studentName, marks: score });

            // Save the updated student data to local storage
            localStorage.setItem('studentData', JSON.stringify(studentData));

            // Generate CSV and download it
            generateCSV(studentData);

            // Redirect to a completion page or display results
            alert("Quiz completed! Your results have been recorded.");
            window.location.href = 'completion.html'; // Redirect to a completion page
        }

        // Function to generate a CSV file
        function generateCSV(data) {
            let csvContent = "Name,Marks\n";
            data.forEach((row) => {
                csvContent += `${row.name},${row.marks}\n`;
            });

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'quiz_results.csv';
            a.click();
        }
    </script>
</head>
<body>
    <h1>Quiz Time!</h1>
    <form id="quiz-form">
        <label>Question 1: What is 2+2?</label><br>
        <input type="radio" name="q1" value="A"> 4<br>
        <input type="radio" name="q1" value="B"> 5<br><br>

        <label>Question 2: What is 3+2?</label><br>
        <input type="radio" name="q2" value="A"> 6<br>
        <input type="radio" name="q2" value="B"> 5<br><br>

        <label>Question 3: What is 5-3?</label><br>
        <input type="radio" name="q3" value="A"> 2<br>
        <input type="radio" name="q3" value="B"> 3<br><br>

        <label>Question 4: What is 9-5?</label><br>
        <input type="radio" name="q4" value="A"> 3<br>
        <input type="radio" name="q4" value="B"> 4<br><br>

        <button type="button" onclick="submitQuiz()">Submit Quiz</button>
    </form>
</body>
</html>